{
	"name": "eCombat",
	"events": [
		{
			"eventType": "variable",
			"name": "CurrentEnemy",
			"type": "string",
			"initialValue": "Dryad",
			"comment": "",
			"isStatic": false,
			"isConstant": false,
			"sid": 993748804141708
		},
		{
			"eventType": "variable",
			"name": "IsPlayerTurn",
			"type": "boolean",
			"initialValue": "true",
			"comment": "",
			"isStatic": false,
			"isConstant": false,
			"sid": 915269375265163
		},
		{
			"eventType": "variable",
			"name": "NumberOfEnemyAbilities",
			"type": "number",
			"initialValue": "0",
			"comment": "",
			"isStatic": false,
			"isConstant": false,
			"sid": 139193172589343
		},
		{
			"eventType": "variable",
			"name": "PlayerMaxHP",
			"type": "number",
			"initialValue": "30",
			"comment": "",
			"isStatic": false,
			"isConstant": false,
			"sid": 236734481628179
		},
		{
			"eventType": "include",
			"includeSheet": "eInit"
		},
		{
			"eventType": "include",
			"includeSheet": "ePrepForCombat"
		},
		{
			"eventType": "block",
			"conditions": [
				{
					"id": "on-nth-touch-end",
					"objectClass": "Touch",
					"sid": 989295156157393,
					"parameters": {
						"touch-number": "0"
					}
				},
				{
					"id": "compare-boolean-eventvar",
					"objectClass": "System",
					"sid": 795640469429975,
					"parameters": {
						"variable": "IsPlayerTurn"
					}
				},
				{
					"id": "is-touching-object",
					"objectClass": "Touch",
					"sid": 377300971435442,
					"parameters": {
						"object": "AbilityButton"
					}
				},
				{
					"id": "is-animation-playing",
					"objectClass": "AbilityButton",
					"sid": 756866748475381,
					"parameters": {
						"animation": "\"Full\""
					}
				}
			],
			"actions": [
				{
					"callFunction": "UseAbility",
					"sid": 187920739872799,
					"parameters": [
						"Functions.GetAbilityBeingUsed(AbilityButton.Slot)",
						"\"Player\""
					]
				}
			],
			"sid": 121693036853967
		},
		{
			"functionName": "UseAbility",
			"functionDescription": "",
			"functionCategory": "",
			"functionReturnType": "none",
			"functionIsAsync": false,
			"functionParameters": [
				{
					"name": "AbilityName",
					"type": "string",
					"initialValue": "",
					"comment": "",
					"sid": 177971052130510
				},
				{
					"name": "Caster",
					"type": "string",
					"initialValue": "",
					"comment": "",
					"sid": 150667746012859
				}
			],
			"eventType": "function-block",
			"conditions": [],
			"actions": [],
			"sid": 505024504528205,
			"children": [
				{
					"eventType": "variable",
					"name": "IsBasicAttack",
					"type": "boolean",
					"initialValue": "false",
					"comment": "",
					"isStatic": false,
					"isConstant": false,
					"sid": 117540557075692
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "compare-boolean-eventvar",
							"objectClass": "System",
							"sid": 992817203117398,
							"parameters": {
								"variable": "IsPlayerTurn"
							}
						}
					],
					"actions": [
						{
							"callFunction": "EndPlayerTurn",
							"sid": 457800085804045
						}
					],
					"sid": 431182316619816
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "else",
							"objectClass": "System",
							"sid": 860833745285222
						}
					],
					"actions": [
						{
							"callFunction": "BeginPlayerTurn",
							"sid": 421876807844890
						}
					],
					"sid": 299219104538996
				},
				{
					"eventType": "block",
					"conditions": [],
					"actions": [
						{
							"callFunction": "BasicAttack",
							"sid": 463539636107141,
							"parameters": [
								"AbilityName",
								"Caster",
								"JSON.Get(\"abilities.\" & AbilityName & \".damageRoll\")"
							]
						}
					],
					"sid": 567554225843951
				}
			]
		},
		{
			"functionName": "BasicAttack",
			"functionDescription": "",
			"functionCategory": "",
			"functionReturnType": "none",
			"functionIsAsync": false,
			"functionParameters": [
				{
					"name": "AttackName",
					"type": "string",
					"initialValue": "",
					"comment": "",
					"sid": 189419425479864
				},
				{
					"name": "Caster",
					"type": "string",
					"initialValue": "",
					"comment": "",
					"sid": 543889386247083
				},
				{
					"name": "DamageRoll",
					"type": "string",
					"initialValue": "",
					"comment": "",
					"sid": 645420139882324
				}
			],
			"eventType": "function-block",
			"conditions": [],
			"actions": [],
			"sid": 638469786085642,
			"children": [
				{
					"eventType": "variable",
					"name": "CharacterTakingDamage",
					"type": "string",
					"initialValue": "",
					"comment": "",
					"isStatic": false,
					"isConstant": false,
					"sid": 639246437848545
				},
				{
					"eventType": "variable",
					"name": "Damage",
					"type": "number",
					"initialValue": "0",
					"comment": "",
					"isStatic": false,
					"isConstant": false,
					"sid": 124277059018778
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "compare-eventvar",
							"objectClass": "System",
							"sid": 151423032203943,
							"parameters": {
								"variable": "Caster",
								"comparison": 0,
								"value": "\"Player\""
							}
						}
					],
					"actions": [
						{
							"id": "set-eventvar-value",
							"objectClass": "System",
							"sid": 747991743316822,
							"parameters": {
								"variable": "CharacterTakingDamage",
								"value": "\"Enemy\""
							}
						}
					],
					"sid": 753201922630949
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "else",
							"objectClass": "System",
							"sid": 424458251773411
						}
					],
					"actions": [
						{
							"id": "set-eventvar-value",
							"objectClass": "System",
							"sid": 320270703610905,
							"parameters": {
								"variable": "CharacterTakingDamage",
								"value": "\"Player\""
							}
						}
					],
					"sid": 445902764969491
				},
				{
					"eventType": "block",
					"conditions": [],
					"actions": [
						{
							"id": "set-eventvar-value",
							"objectClass": "System",
							"sid": 431192535619493,
							"parameters": {
								"variable": "Damage",
								"value": "Functions.ParseDice(Ability.DamageRoll)"
							}
						},
						{
							"callFunction": "TakeDamage",
							"sid": 753876660996442,
							"parameters": [
								"CharacterTakingDamage",
								"Damage"
							]
						}
					],
					"sid": 213878302360613
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "compare-eventvar",
							"objectClass": "System",
							"sid": 240117541699222,
							"parameters": {
								"variable": "Caster",
								"comparison": 0,
								"value": "\"Player\""
							}
						},
						{
							"id": "compare-instance-variable",
							"objectClass": "Text",
							"sid": 530989381958940,
							"parameters": {
								"instance-variable": "Name",
								"comparison": 0,
								"value": "\"Combat Log\""
							}
						}
					],
					"actions": [
						{
							"id": "append-text",
							"objectClass": "Text",
							"sid": 328212279499192,
							"parameters": {
								"text": "Functions.ReplaceCombatLogVariables(Player.Name, JSON.Get(\"abilities.\" & AttackName & \".combatLogProc\"), Damage, Enemy.Name) & newline"
							}
						}
					],
					"sid": 557497428511977
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "else",
							"objectClass": "System",
							"sid": 760598115113732
						},
						{
							"id": "compare-instance-variable",
							"objectClass": "Text",
							"sid": 351180654404073,
							"parameters": {
								"instance-variable": "Name",
								"comparison": 0,
								"value": "\"Combat Log\""
							}
						}
					],
					"actions": [
						{
							"id": "append-text",
							"objectClass": "Text",
							"sid": 817522365408553,
							"parameters": {
								"text": "Functions.ReplaceCombatLogVariables(Enemy.Name, JSON.Get(\"abilities.\" & AttackName & \".combatLogProc\"), Damage, Player.Name) & newline"
							}
						}
					],
					"sid": 311188751874758
				}
			]
		},
		{
			"functionName": "TakeDamage",
			"functionDescription": "",
			"functionCategory": "",
			"functionReturnType": "none",
			"functionIsAsync": false,
			"functionParameters": [
				{
					"name": "Character",
					"type": "string",
					"initialValue": "",
					"comment": "",
					"sid": 709029003585657
				},
				{
					"name": "Damage",
					"type": "number",
					"initialValue": "0",
					"comment": "",
					"sid": 833276158252624
				}
			],
			"eventType": "function-block",
			"conditions": [],
			"actions": [],
			"sid": 310753636017706,
			"children": [
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "compare-eventvar",
							"objectClass": "System",
							"sid": 923895575125301,
							"parameters": {
								"variable": "Character",
								"comparison": 0,
								"value": "\"Player\""
							}
						}
					],
					"actions": [
						{
							"id": "set-instvar-value",
							"objectClass": "Player",
							"sid": 654533775219930,
							"parameters": {
								"instance-variable": "CurrentHP",
								"value": "max(0, Player.CurrentHP - Damage)"
							}
						},
						{
							"callFunction": "SetPlayerHPText",
							"sid": 263295434213226
						}
					],
					"sid": 595618893551063
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "compare-eventvar",
							"objectClass": "System",
							"sid": 407154079398723,
							"parameters": {
								"variable": "Character",
								"comparison": 0,
								"value": "\"Enemy\""
							}
						}
					],
					"actions": [
						{
							"id": "set-instvar-value",
							"objectClass": "Enemy",
							"sid": 322599751624221,
							"parameters": {
								"instance-variable": "CurrentHP",
								"value": "max(0, Enemy.CurrentHP - Damage)"
							}
						},
						{
							"callFunction": "SetEnemyHPText",
							"sid": 967507585850578
						}
					],
					"sid": 628157594835834
				}
			]
		},
		{
			"functionName": "BeginPlayerTurn",
			"functionDescription": "",
			"functionCategory": "",
			"functionReturnType": "none",
			"functionIsAsync": false,
			"functionParameters": [],
			"eventType": "function-block",
			"conditions": [],
			"actions": [
				{
					"id": "set-boolean-eventvar",
					"objectClass": "System",
					"sid": 894336418033114,
					"parameters": {
						"variable": "IsPlayerTurn",
						"value": "true"
					}
				},
				{
					"id": "set-opacity",
					"objectClass": "AbilityButton",
					"sid": 779881574022131,
					"parameters": {
						"opacity": "100"
					}
				},
				{
					"id": "set-opacity",
					"objectClass": "Ability",
					"sid": 914471632430023,
					"parameters": {
						"opacity": "100"
					}
				}
			],
			"sid": 688599025958955
		},
		{
			"functionName": "EndPlayerTurn",
			"functionDescription": "",
			"functionCategory": "",
			"functionReturnType": "none",
			"functionIsAsync": false,
			"functionParameters": [],
			"eventType": "function-block",
			"conditions": [],
			"actions": [
				{
					"id": "set-boolean-eventvar",
					"objectClass": "System",
					"sid": 235821678193045,
					"parameters": {
						"variable": "IsPlayerTurn",
						"value": "false"
					}
				},
				{
					"id": "set-opacity",
					"objectClass": "AbilityButton",
					"sid": 291907635731462,
					"parameters": {
						"opacity": "30"
					}
				},
				{
					"id": "set-opacity",
					"objectClass": "Ability",
					"sid": 543664109853206,
					"parameters": {
						"opacity": "30"
					}
				},
				{
					"callFunction": "TakeEnemyTurn",
					"sid": 469651095172224
				}
			],
			"sid": 176986080249516
		},
		{
			"functionName": "TakeEnemyTurn",
			"functionDescription": "",
			"functionCategory": "",
			"functionReturnType": "none",
			"functionIsAsync": false,
			"functionParameters": [],
			"eventType": "function-block",
			"conditions": [],
			"actions": [
				{
					"id": "wait",
					"objectClass": "System",
					"sid": 198748695884025,
					"parameters": {
						"seconds": "1"
					}
				},
				{
					"id": "wait-for-previous-actions",
					"objectClass": "System",
					"sid": 201588118623337
				},
				{
					"type": "comment",
					"text": "TODO: use random ability from NumberOfEnemyAbilities"
				},
				{
					"callFunction": "UseAbility",
					"sid": 822973693222747,
					"parameters": [
						"Enemy.Ability1",
						"\"Enemy\""
					]
				}
			],
			"sid": 687586611543011
		}
	],
	"sid": 772248937910943
}