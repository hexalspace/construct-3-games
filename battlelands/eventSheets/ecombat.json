{
	"name": "eCombat",
	"events": [
		{
			"eventType": "variable",
			"name": "IsInCombat",
			"type": "boolean",
			"initialValue": "true",
			"comment": "",
			"isStatic": false,
			"isConstant": false,
			"sid": 700250997080384
		},
		{
			"eventType": "variable",
			"name": "IsPlayerTurn",
			"type": "boolean",
			"initialValue": "true",
			"comment": "",
			"isStatic": false,
			"isConstant": false,
			"sid": 800168650250549
		},
		{
			"eventType": "variable",
			"name": "NumberOfEnemyAbilities",
			"type": "number",
			"initialValue": "0",
			"comment": "",
			"isStatic": false,
			"isConstant": false,
			"sid": 139193172589343
		},
		{
			"eventType": "variable",
			"name": "PlayerLevel",
			"type": "number",
			"initialValue": "1",
			"comment": "",
			"isStatic": false,
			"isConstant": false,
			"sid": 178025144690445
		},
		{
			"eventType": "variable",
			"name": "PlayerMaxHP",
			"type": "number",
			"initialValue": "30",
			"comment": "",
			"isStatic": false,
			"isConstant": false,
			"sid": 236734481628179
		},
		{
			"eventType": "include",
			"includeSheet": "eAcquireAbility"
		},
		{
			"eventType": "include",
			"includeSheet": "eMouse"
		},
		{
			"eventType": "include",
			"includeSheet": "ePrepForCombat"
		},
		{
			"eventType": "comment",
			"text": "non-attack abilities"
		},
		{
			"eventType": "variable",
			"name": "BARKSKIN_DAMAGE_REDUCTION",
			"type": "number",
			"initialValue": "0.25",
			"comment": "",
			"isStatic": false,
			"isConstant": true,
			"sid": 534293659872592
		},
		{
			"eventType": "variable",
			"name": "INVISIBILITY_PROC_CHANCE2",
			"type": "number",
			"initialValue": "0.25",
			"comment": "",
			"isStatic": false,
			"isConstant": true,
			"sid": 405229762505103
		},
		{
			"eventType": "variable",
			"name": "INFINITE_TURNS",
			"type": "number",
			"initialValue": "1000",
			"comment": "",
			"isStatic": false,
			"isConstant": true,
			"sid": 131110883632641
		},
		{
			"eventType": "block",
			"conditions": [
				{
					"id": "on-nth-touch-end",
					"objectClass": "Touch",
					"sid": 989295156157393,
					"parameters": {
						"touch-number": "0"
					}
				},
				{
					"id": "compare-boolean-eventvar",
					"objectClass": "System",
					"sid": 795640469429975,
					"parameters": {
						"variable": "IsPlayerTurn"
					}
				},
				{
					"id": "is-touching-object",
					"objectClass": "Touch",
					"sid": 377300971435442,
					"parameters": {
						"object": "AbilityButton"
					}
				},
				{
					"id": "is-animation-playing",
					"objectClass": "AbilityButton",
					"sid": 756866748475381,
					"parameters": {
						"animation": "\"Full\""
					}
				}
			],
			"actions": [
				{
					"callFunction": "UseAbility",
					"sid": 308351389961807,
					"parameters": [
						"Functions.GetAbilityBeingUsed(AbilityButton.Slot)",
						"\"Player\"",
						"Player.Level"
					]
				}
			],
			"sid": 121693036853967
		},
		{
			"functionName": "UseAbility",
			"functionDescription": "",
			"functionCategory": "",
			"functionReturnType": "none",
			"functionIsAsync": false,
			"functionParameters": [
				{
					"name": "AbilityName",
					"type": "string",
					"initialValue": "",
					"comment": "",
					"sid": 177971052130510
				},
				{
					"name": "Caster",
					"type": "string",
					"initialValue": "",
					"comment": "",
					"sid": 150667746012859
				},
				{
					"name": "CasterLevel",
					"type": "number",
					"initialValue": "1",
					"comment": "",
					"sid": 215922913768303
				}
			],
			"eventType": "function-block",
			"conditions": [],
			"actions": [],
			"sid": 505024504528205,
			"children": [
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "compare-boolean-eventvar",
							"objectClass": "System",
							"sid": 992817203117398,
							"parameters": {
								"variable": "IsPlayerTurn"
							}
						}
					],
					"actions": [
						{
							"callFunction": "BlockPlayerCasting",
							"sid": 435025167971787
						}
					],
					"sid": 431182316619816
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "else",
							"objectClass": "System",
							"sid": 860833745285222
						}
					],
					"actions": [
						{
							"callFunction": "AllowPlayerCasting",
							"sid": 721841713921823
						}
					],
					"sid": 299219104538996
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "compare-two-values",
							"objectClass": "System",
							"sid": 948702528410540,
							"parameters": {
								"first-value": "JSON.Get(\"abilities.\" & AbilityName & \".isBasicAttack\")",
								"comparison": 0,
								"second-value": "1"
							}
						}
					],
					"actions": [
						{
							"callFunction": "BasicAttack",
							"sid": 872419993758438,
							"parameters": [
								"AbilityName",
								"Caster",
								"CasterLevel",
								"JSON.Get(\"abilities.\" & AbilityName & \".damageRoll\")"
							]
						}
					],
					"sid": 418975993389134
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "else",
							"objectClass": "System",
							"sid": 737692208401957
						}
					],
					"actions": [
						{
							"type": "comment",
							"text": "TODO: add other abilities"
						}
					],
					"sid": 352001357333709,
					"children": [
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "compare-eventvar",
									"objectClass": "System",
									"sid": 136239140108669,
									"parameters": {
										"variable": "AbilityName",
										"comparison": 0,
										"value": "\"Invisibility\""
									}
								}
							],
							"actions": [
								{
									"callFunction": "CastInvisibility",
									"sid": 947742398028013,
									"parameters": [
										"Caster"
									]
								}
							],
							"sid": 275242531572349
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "compare-eventvar",
									"objectClass": "System",
									"sid": 838321336978703,
									"parameters": {
										"variable": "AbilityName",
										"comparison": 0,
										"value": "\"Barkskin\""
									}
								}
							],
							"actions": [
								{
									"callFunction": "CastBarkskin",
									"sid": 233718148632193,
									"parameters": [
										"Caster"
									]
								}
							],
							"sid": 240345887703788
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "compare-eventvar",
									"objectClass": "System",
									"sid": 420834816655133,
									"parameters": {
										"variable": "AbilityName",
										"comparison": 0,
										"value": "\"Sleep\""
									}
								}
							],
							"actions": [
								{
									"callFunction": "CastSleep",
									"sid": 536171317519648,
									"parameters": [
										"Caster"
									]
								}
							],
							"sid": 852420377789663
						}
					]
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "compare-boolean-eventvar",
							"objectClass": "System",
							"sid": 844673150008878,
							"parameters": {
								"variable": "IsPlayerTurn"
							},
							"isInverted": true
						}
					],
					"actions": [
						{
							"callFunction": "EndPlayerTurn",
							"sid": 884669954501331
						}
					],
					"sid": 212124626237434
				}
			]
		},
		{
			"functionName": "UseRandomEnemyAbility",
			"functionDescription": "",
			"functionCategory": "",
			"functionReturnType": "none",
			"functionIsAsync": false,
			"functionParameters": [
				{
					"name": "Caster",
					"type": "string",
					"initialValue": "",
					"comment": "",
					"sid": 974552085055900
				},
				{
					"name": "CasterLevel",
					"type": "number",
					"initialValue": "1",
					"comment": "",
					"sid": 743288569749823
				}
			],
			"eventType": "function-block",
			"conditions": [],
			"actions": [
				{
					"callFunction": "UseAbility",
					"sid": 593794627744630,
					"parameters": [
						"Functions.GetRandomEnemyAbility",
						"Caster",
						"CasterLevel"
					]
				}
			],
			"sid": 547333560158726
		},
		{
			"functionName": "BasicAttack",
			"functionDescription": "",
			"functionCategory": "",
			"functionReturnType": "none",
			"functionIsAsync": false,
			"functionParameters": [
				{
					"name": "AttackName",
					"type": "string",
					"initialValue": "",
					"comment": "",
					"sid": 189419425479864
				},
				{
					"name": "Caster",
					"type": "string",
					"initialValue": "",
					"comment": "",
					"sid": 543889386247083
				},
				{
					"name": "CasterLevel",
					"type": "number",
					"initialValue": "1",
					"comment": "",
					"sid": 410063865450681
				},
				{
					"name": "DamageRoll",
					"type": "string",
					"initialValue": "",
					"comment": "",
					"sid": 645420139882324
				}
			],
			"eventType": "function-block",
			"conditions": [],
			"actions": [],
			"sid": 638469786085642,
			"children": [
				{
					"eventType": "variable",
					"name": "Defender",
					"type": "string",
					"initialValue": "",
					"comment": "",
					"isStatic": false,
					"isConstant": false,
					"sid": 639246437848545
				},
				{
					"eventType": "variable",
					"name": "CasterName",
					"type": "string",
					"initialValue": "",
					"comment": "",
					"isStatic": false,
					"isConstant": false,
					"sid": 665549364971322
				},
				{
					"eventType": "variable",
					"name": "DefenderName",
					"type": "string",
					"initialValue": "",
					"comment": "",
					"isStatic": false,
					"isConstant": false,
					"sid": 647787275588763
				},
				{
					"eventType": "variable",
					"name": "OriginalDamage",
					"type": "number",
					"initialValue": "0",
					"comment": "",
					"isStatic": false,
					"isConstant": false,
					"sid": 124277059018778
				},
				{
					"eventType": "variable",
					"name": "ModifiedDamage",
					"type": "number",
					"initialValue": "0",
					"comment": "",
					"isStatic": false,
					"isConstant": false,
					"sid": 266098949164952
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "compare-eventvar",
							"objectClass": "System",
							"sid": 151423032203943,
							"parameters": {
								"variable": "Caster",
								"comparison": 0,
								"value": "\"Player\""
							}
						}
					],
					"actions": [
						{
							"id": "set-eventvar-value",
							"objectClass": "System",
							"sid": 654536406856228,
							"parameters": {
								"variable": "CasterName",
								"value": "Player.Name"
							}
						},
						{
							"id": "set-eventvar-value",
							"objectClass": "System",
							"sid": 747991743316822,
							"parameters": {
								"variable": "Defender",
								"value": "\"Enemy\""
							}
						},
						{
							"id": "set-eventvar-value",
							"objectClass": "System",
							"sid": 994398548946292,
							"parameters": {
								"variable": "DefenderName",
								"value": "Enemy.Name"
							}
						}
					],
					"sid": 753201922630949
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "else",
							"objectClass": "System",
							"sid": 424458251773411
						}
					],
					"actions": [
						{
							"id": "set-eventvar-value",
							"objectClass": "System",
							"sid": 510791094523073,
							"parameters": {
								"variable": "CasterName",
								"value": "Enemy.Name"
							}
						},
						{
							"id": "set-eventvar-value",
							"objectClass": "System",
							"sid": 320270703610905,
							"parameters": {
								"variable": "Defender",
								"value": "\"Player\""
							}
						},
						{
							"id": "set-eventvar-value",
							"objectClass": "System",
							"sid": 208997778865240,
							"parameters": {
								"variable": "DefenderName",
								"value": "Player.Name"
							}
						}
					],
					"sid": 445902764969491
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "compare-two-values",
							"objectClass": "System",
							"sid": 614938109317851,
							"parameters": {
								"first-value": "Functions.GetIsCharacterUnableToAttack(Caster)",
								"comparison": 0,
								"second-value": "1"
							}
						}
					],
					"actions": [
						{
							"callFunction": "AppendToCombatLog",
							"sid": 379684660911085,
							"parameters": [
								"CasterName & \" is unable to attack because of Sleep.\""
							]
						}
					],
					"sid": 921396557019221
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "else",
							"objectClass": "System",
							"sid": 309984271131911
						}
					],
					"actions": [
						{
							"id": "set-eventvar-value",
							"objectClass": "System",
							"sid": 944790462573964,
							"parameters": {
								"variable": "OriginalDamage",
								"value": "Functions.ParseDice(Ability.DamageRoll)"
							}
						},
						{
							"id": "add-to-eventvar",
							"objectClass": "System",
							"sid": 607060921107503,
							"parameters": {
								"variable": "OriginalDamage",
								"value": "CasterLevel * 5"
							}
						},
						{
							"id": "set-eventvar-value",
							"objectClass": "System",
							"sid": 880917605710207,
							"parameters": {
								"variable": "ModifiedDamage",
								"value": "OriginalDamage"
							}
						}
					],
					"sid": 429067590443857,
					"children": [
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "compare-two-values",
									"objectClass": "System",
									"sid": 707012658359617,
									"parameters": {
										"first-value": "Functions.GetIsAttackReducedByBarkskin(Defender)",
										"comparison": 0,
										"second-value": "1"
									}
								}
							],
							"actions": [
								{
									"id": "set-eventvar-value",
									"objectClass": "System",
									"sid": 124560956098405,
									"parameters": {
										"variable": "ModifiedDamage",
										"value": "ceil((1 - BARKSKIN_DAMAGE_REDUCTION) * OriginalDamage)"
									}
								}
							],
							"sid": 151326099229102
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "compare-two-values",
									"objectClass": "System",
									"sid": 414024692560386,
									"parameters": {
										"first-value": "Functions.GetIsAttackNegatedByInvisibility(Defender)",
										"comparison": 0,
										"second-value": "1"
									}
								}
							],
							"actions": [
								{
									"callFunction": "AppendToCombatLog",
									"sid": 101930494499248,
									"parameters": [
										"CasterName & \" attempts to hit \" & DefenderName & \" with \" & AttackName & \".\""
									]
								},
								{
									"callFunction": "AppendToCombatLog",
									"sid": 865594517516096,
									"parameters": [
										"Functions.ReplaceCombatLogVariables(DefenderName, JSON.Get(\"abilities.Invisibility.combatLogProc\"), 0, \"\")"
									]
								}
							],
							"sid": 468064775031870
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "else",
									"objectClass": "System",
									"sid": 279066005892809
								}
							],
							"actions": [
								{
									"callFunction": "AppendToCombatLog",
									"sid": 487288339503923,
									"parameters": [
										"Functions.ReplaceCombatLogVariables(CasterName, JSON.Get(\"abilities.\" & AttackName & \".combatLogProc\"), OriginalDamage, DefenderName)"
									]
								},
								{
									"callFunction": "TakeDamage",
									"sid": 207833102484385,
									"parameters": [
										"Defender",
										"OriginalDamage"
									]
								}
							],
							"sid": 126040001521677
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "compare-two-values",
									"objectClass": "System",
									"sid": 895163563570830,
									"parameters": {
										"first-value": "Functions.GetIsAttackReducedByBarkskin(Defender)",
										"comparison": 0,
										"second-value": "1"
									}
								}
							],
							"actions": [
								{
									"callFunction": "AppendToCombatLog",
									"sid": 644857451181140,
									"parameters": [
										"\"Damage is reduced to \" & ModifiedDamage & \" HP by \" & DefenderName & \"'s Barkskin.\""
									]
								}
							],
							"sid": 305792669338203
						}
					]
				}
			]
		},
		{
			"functionName": "CastInvisibility",
			"functionDescription": "",
			"functionCategory": "Abilities",
			"functionReturnType": "none",
			"functionIsAsync": false,
			"functionParameters": [
				{
					"name": "Caster",
					"type": "string",
					"initialValue": "",
					"comment": "",
					"sid": 664465241281780
				}
			],
			"eventType": "function-block",
			"conditions": [],
			"actions": [],
			"sid": 461486173130049,
			"children": [
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "compare-eventvar",
							"objectClass": "System",
							"sid": 901814775172556,
							"parameters": {
								"variable": "Caster",
								"comparison": 0,
								"value": "\"Player\""
							}
						}
					],
					"actions": [],
					"sid": 325054905856096,
					"children": [
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "contains-value",
									"objectClass": "PlayerBuffs",
									"sid": 691840209423014,
									"parameters": {
										"value": "\"Invisibility\""
									}
								}
							],
							"actions": [
								{
									"callFunction": "AppendToCombatLog",
									"sid": 756283790948084,
									"parameters": [
										"Player.Name & \" casts Invisibility. Nothing happens.\""
									]
								}
							],
							"sid": 799265140311171
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "else",
									"objectClass": "System",
									"sid": 167127343200889
								}
							],
							"actions": [
								{
									"id": "push",
									"objectClass": "PlayerBuffs",
									"sid": 709041400658963,
									"parameters": {
										"where": "back",
										"value": "\"Invisibility\"",
										"axis": "x"
									}
								},
								{
									"id": "set-at-xy",
									"objectClass": "PlayerBuffs",
									"sid": 712680549109113,
									"parameters": {
										"x": "PlayerBuffs.Width - 1",
										"y": "1",
										"value": "INFINITE_TURNS"
									}
								},
								{
									"callFunction": "AppendToCombatLog",
									"sid": 219607869762821,
									"parameters": [
										"Functions.ReplaceCombatLogVariables(Player.Name, JSON.Get(\"abilities.Invisibility.combatLogCast\"), 0, Enemy.Name)"
									]
								},
								{
									"callFunction": "RedrawBuffs",
									"sid": 630655081164070,
									"parameters": [
										"\"Player\""
									]
								}
							],
							"sid": 318734837729282
						}
					]
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "else",
							"objectClass": "System",
							"sid": 833119859227426
						}
					],
					"actions": [],
					"sid": 558137093509784,
					"children": [
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "contains-value",
									"objectClass": "EnemyBuffs",
									"sid": 111513856627048,
									"parameters": {
										"value": "\"Invisibility\""
									}
								}
							],
							"actions": [
								{
									"callFunction": "AppendToCombatLog",
									"sid": 335854486640421,
									"parameters": [
										"Enemy.Name & \" casts Invisibility. Nothing happens.\""
									]
								}
							],
							"sid": 154905138011186
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "else",
									"objectClass": "System",
									"sid": 983218698267883
								}
							],
							"actions": [
								{
									"id": "push",
									"objectClass": "EnemyBuffs",
									"sid": 981507283263210,
									"parameters": {
										"where": "back",
										"value": "\"Invisibility\"",
										"axis": "x"
									}
								},
								{
									"id": "set-at-xy",
									"objectClass": "EnemyBuffs",
									"sid": 189524797406687,
									"parameters": {
										"x": "EnemyBuffs.Width - 1",
										"y": "1",
										"value": "INFINITE_TURNS"
									}
								},
								{
									"callFunction": "AppendToCombatLog",
									"sid": 440199740593416,
									"parameters": [
										"Functions.ReplaceCombatLogVariables(Enemy.Name, JSON.Get(\"abilities.Invisibility.combatLogCast\"), 0, Player.Name)"
									]
								},
								{
									"callFunction": "RedrawBuffs",
									"sid": 843053155413466,
									"parameters": [
										"\"Enemy\""
									]
								}
							],
							"sid": 895995599112871
						}
					]
				}
			]
		},
		{
			"functionName": "CastBarkskin",
			"functionDescription": "",
			"functionCategory": "Abilities",
			"functionReturnType": "none",
			"functionIsAsync": false,
			"functionParameters": [
				{
					"name": "Caster",
					"type": "string",
					"initialValue": "",
					"comment": "",
					"sid": 511913941814724
				}
			],
			"eventType": "function-block",
			"conditions": [],
			"actions": [],
			"sid": 476019812775209,
			"children": [
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "compare-eventvar",
							"objectClass": "System",
							"sid": 378919631407698,
							"parameters": {
								"variable": "Caster",
								"comparison": 0,
								"value": "\"Player\""
							}
						}
					],
					"actions": [],
					"sid": 833139547347337,
					"children": [
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "contains-value",
									"objectClass": "PlayerBuffs",
									"sid": 525087064522809,
									"parameters": {
										"value": "\"Barkskin\""
									}
								}
							],
							"actions": [
								{
									"callFunction": "AppendToCombatLog",
									"sid": 102715780206973,
									"parameters": [
										"Player.Name & \" casts Barkskin. Nothing happens.\""
									]
								}
							],
							"sid": 924684483820242
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "else",
									"objectClass": "System",
									"sid": 285699085848343
								}
							],
							"actions": [
								{
									"id": "push",
									"objectClass": "PlayerBuffs",
									"sid": 399817143768866,
									"parameters": {
										"where": "back",
										"value": "\"Barkskin\"",
										"axis": "x"
									}
								},
								{
									"id": "set-at-xy",
									"objectClass": "PlayerBuffs",
									"sid": 924827162897091,
									"parameters": {
										"x": "PlayerBuffs.Width - 1",
										"y": "1",
										"value": "INFINITE_TURNS"
									}
								},
								{
									"callFunction": "AppendToCombatLog",
									"sid": 218316127279799,
									"parameters": [
										"Functions.ReplaceCombatLogVariables(Player.Name, JSON.Get(\"abilities.Barkskin.combatLogCast\"), 0, Enemy.Name)"
									]
								},
								{
									"callFunction": "RedrawBuffs",
									"sid": 186119031816898,
									"parameters": [
										"\"Player\""
									]
								}
							],
							"sid": 548170709890122
						}
					]
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "else",
							"objectClass": "System",
							"sid": 990598605461987
						}
					],
					"actions": [],
					"sid": 285603222459922,
					"children": [
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "contains-value",
									"objectClass": "EnemyBuffs",
									"sid": 406354014758005,
									"parameters": {
										"value": "\"Barkskin\""
									}
								}
							],
							"actions": [
								{
									"callFunction": "AppendToCombatLog",
									"sid": 218468615327573,
									"parameters": [
										"Enemy.Name & \" casts Barkskin. Nothing happens.\""
									]
								}
							],
							"sid": 606583350428535
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "else",
									"objectClass": "System",
									"sid": 154805890891281
								}
							],
							"actions": [
								{
									"id": "push",
									"objectClass": "EnemyBuffs",
									"sid": 843174973697841,
									"parameters": {
										"where": "back",
										"value": "\"Barkskin\"",
										"axis": "x"
									}
								},
								{
									"id": "set-at-xy",
									"objectClass": "EnemyBuffs",
									"sid": 336367480012679,
									"parameters": {
										"x": "EnemyBuffs.Width - 1",
										"y": "1",
										"value": "INFINITE_TURNS"
									}
								},
								{
									"callFunction": "AppendToCombatLog",
									"sid": 537548302529362,
									"parameters": [
										"Functions.ReplaceCombatLogVariables(Enemy.Name, JSON.Get(\"abilities.Barkskin.combatLogCast\"), 0, Player.Name)"
									]
								},
								{
									"callFunction": "RedrawBuffs",
									"sid": 808512544098372,
									"parameters": [
										"\"Enemy\""
									]
								}
							],
							"sid": 600146221370867
						}
					]
				}
			]
		},
		{
			"functionName": "CastSleep",
			"functionDescription": "",
			"functionCategory": "Abilities",
			"functionReturnType": "none",
			"functionIsAsync": false,
			"functionParameters": [
				{
					"name": "Caster",
					"type": "string",
					"initialValue": "",
					"comment": "",
					"sid": 136320960525824
				}
			],
			"eventType": "function-block",
			"conditions": [],
			"actions": [],
			"sid": 976602144863648,
			"children": [
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "compare-eventvar",
							"objectClass": "System",
							"sid": 753277298578316,
							"parameters": {
								"variable": "Caster",
								"comparison": 0,
								"value": "\"Player\""
							}
						}
					],
					"actions": [
						{
							"id": "push",
							"objectClass": "EnemyBuffs",
							"sid": 361168144531218,
							"parameters": {
								"where": "back",
								"value": "\"Sleep\"",
								"axis": "x"
							}
						},
						{
							"id": "set-at-xy",
							"objectClass": "EnemyBuffs",
							"sid": 329612521141542,
							"parameters": {
								"x": "EnemyBuffs.Width - 1",
								"y": "1",
								"value": "1"
							}
						},
						{
							"callFunction": "AppendToCombatLog",
							"sid": 783247105845525,
							"parameters": [
								"Functions.ReplaceCombatLogVariables(Player.Name, JSON.Get(\"abilities.Sleep.combatLogCast\"), 0, Enemy.Name)"
							]
						},
						{
							"callFunction": "RedrawBuffs",
							"sid": 385027932051546,
							"parameters": [
								"\"Enemy\""
							]
						}
					],
					"sid": 311528835461012
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "else",
							"objectClass": "System",
							"sid": 754775279814695
						}
					],
					"actions": [
						{
							"id": "push",
							"objectClass": "PlayerBuffs",
							"sid": 952264497149609,
							"parameters": {
								"where": "back",
								"value": "\"Sleep\"",
								"axis": "x"
							}
						},
						{
							"id": "set-at-xy",
							"objectClass": "PlayerBuffs",
							"sid": 832274506109007,
							"parameters": {
								"x": "PlayerBuffs.Width - 1",
								"y": "1",
								"value": "1"
							}
						},
						{
							"callFunction": "AppendToCombatLog",
							"sid": 793841255270591,
							"parameters": [
								"Functions.ReplaceCombatLogVariables(Enemy.Name, JSON.Get(\"abilities.Sleep.combatLogCast\"), 0, Player.Name)"
							]
						},
						{
							"callFunction": "RedrawBuffs",
							"sid": 947473851538276,
							"parameters": [
								"\"Player\""
							]
						}
					],
					"sid": 834045658794849
				}
			]
		},
		{
			"functionName": "TakeDamage",
			"functionDescription": "",
			"functionCategory": "",
			"functionReturnType": "none",
			"functionIsAsync": false,
			"functionParameters": [
				{
					"name": "Character",
					"type": "string",
					"initialValue": "",
					"comment": "",
					"sid": 709029003585657
				},
				{
					"name": "Damage",
					"type": "number",
					"initialValue": "0",
					"comment": "",
					"sid": 833276158252624
				}
			],
			"eventType": "function-block",
			"conditions": [],
			"actions": [],
			"sid": 310753636017706,
			"children": [
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "compare-eventvar",
							"objectClass": "System",
							"sid": 923895575125301,
							"parameters": {
								"variable": "Character",
								"comparison": 0,
								"value": "\"Player\""
							}
						}
					],
					"actions": [
						{
							"id": "set-instvar-value",
							"objectClass": "Player",
							"sid": 654533775219930,
							"parameters": {
								"instance-variable": "CurrentHP",
								"value": "max(0, Player.CurrentHP - Damage)"
							}
						},
						{
							"callFunction": "SetPlayerHPText",
							"sid": 263295434213226
						}
					],
					"sid": 595618893551063,
					"children": [
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "compare-two-values",
									"objectClass": "System",
									"sid": 876333774019212,
									"parameters": {
										"first-value": "Player.CurrentHP",
										"comparison": 3,
										"second-value": "0"
									}
								}
							],
							"actions": [
								{
									"callFunction": "PlayerDies",
									"sid": 300789588670671
								}
							],
							"sid": 973397490765494
						}
					]
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "compare-eventvar",
							"objectClass": "System",
							"sid": 407154079398723,
							"parameters": {
								"variable": "Character",
								"comparison": 0,
								"value": "\"Enemy\""
							}
						}
					],
					"actions": [
						{
							"id": "set-instvar-value",
							"objectClass": "Enemy",
							"sid": 322599751624221,
							"parameters": {
								"instance-variable": "CurrentHP",
								"value": "max(0, Enemy.CurrentHP - Damage)"
							}
						},
						{
							"callFunction": "SetEnemyHPText",
							"sid": 967507585850578
						}
					],
					"sid": 628157594835834,
					"children": [
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "compare-two-values",
									"objectClass": "System",
									"sid": 788155578569189,
									"parameters": {
										"first-value": "Enemy.CurrentHP",
										"comparison": 3,
										"second-value": "0"
									}
								}
							],
							"actions": [
								{
									"callFunction": "EnemyDies",
									"sid": 597444235288387
								}
							],
							"sid": 281106736026725
						}
					]
				}
			]
		},
		{
			"functionName": "AllowPlayerCasting",
			"functionDescription": "",
			"functionCategory": "",
			"functionReturnType": "none",
			"functionIsAsync": false,
			"functionParameters": [],
			"eventType": "function-block",
			"conditions": [],
			"actions": [
				{
					"id": "set-boolean-eventvar",
					"objectClass": "System",
					"sid": 547171857233670,
					"parameters": {
						"variable": "IsPlayerTurn",
						"value": "true"
					}
				},
				{
					"id": "set-opacity",
					"objectClass": "AbilityButton",
					"sid": 273013236228053,
					"parameters": {
						"opacity": "100"
					}
				},
				{
					"id": "set-opacity",
					"objectClass": "FleeButton",
					"sid": 148528170201367,
					"parameters": {
						"opacity": "100"
					}
				},
				{
					"id": "set-opacity",
					"objectClass": "Ability",
					"sid": 398219846068796,
					"parameters": {
						"opacity": "100"
					}
				}
			],
			"sid": 345878766042527
		},
		{
			"functionName": "BlockPlayerCasting",
			"functionDescription": "",
			"functionCategory": "",
			"functionReturnType": "none",
			"functionIsAsync": false,
			"functionParameters": [],
			"eventType": "function-block",
			"conditions": [],
			"actions": [
				{
					"id": "set-boolean-eventvar",
					"objectClass": "System",
					"sid": 962697040539402,
					"parameters": {
						"variable": "IsPlayerTurn",
						"value": "false"
					}
				},
				{
					"id": "set-opacity",
					"objectClass": "AbilityButton",
					"sid": 234039509065494,
					"parameters": {
						"opacity": "30"
					}
				},
				{
					"id": "set-opacity",
					"objectClass": "FleeButton",
					"sid": 273047696060067,
					"parameters": {
						"opacity": "30"
					}
				},
				{
					"id": "set-opacity",
					"objectClass": "Ability",
					"sid": 340904728727530,
					"parameters": {
						"opacity": "30"
					}
				}
			],
			"sid": 675271122384392
		},
		{
			"functionName": "EndPlayerTurn",
			"functionDescription": "",
			"functionCategory": "",
			"functionReturnType": "none",
			"functionIsAsync": false,
			"functionParameters": [],
			"eventType": "function-block",
			"conditions": [],
			"actions": [],
			"sid": 176986080249516,
			"children": [
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "compare-instance-variable",
							"objectClass": "Enemy",
							"sid": 984426148598400,
							"parameters": {
								"instance-variable": "CurrentHP",
								"comparison": 4,
								"value": "0"
							}
						},
						{
							"id": "compare-instance-variable",
							"objectClass": "Player",
							"sid": 550287863274908,
							"parameters": {
								"instance-variable": "CurrentHP",
								"comparison": 4,
								"value": "0"
							}
						}
					],
					"actions": [
						{
							"callFunction": "TakeEnemyTurn",
							"sid": 808275995886139
						}
					],
					"sid": 652712357910562
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "compare-size",
							"objectClass": "PlayerBuffs",
							"sid": 888005941704771,
							"parameters": {
								"axis": "x",
								"comparison": 4,
								"value": "0"
							}
						}
					],
					"actions": [],
					"sid": 332901915581612,
					"children": [
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "for",
									"objectClass": "System",
									"sid": 643971146218622,
									"parameters": {
										"name": "\"\"",
										"start-index": "0",
										"end-index": "PlayerBuffs.Width - 1"
									}
								}
							],
							"actions": [
								{
									"type": "comment",
									"text": "reverse loop"
								},
								{
									"id": "log",
									"objectClass": "Browser",
									"sid": 153795569949555,
									"parameters": {
										"type": "log",
										"message": "\"looping backwards: indices:\""
									}
								}
							],
							"sid": 331935777650171,
							"children": [
								{
									"eventType": "variable",
									"name": "Index",
									"type": "number",
									"initialValue": "0",
									"comment": "",
									"isStatic": false,
									"isConstant": false,
									"sid": 997833312273584
								},
								{
									"eventType": "block",
									"conditions": [],
									"actions": [
										{
											"id": "set-eventvar-value",
											"objectClass": "System",
											"sid": 841040787036340,
											"parameters": {
												"variable": "Index",
												"value": "PlayerBuffs.Width - 1 - loopindex"
											}
										},
										{
											"id": "log",
											"objectClass": "Browser",
											"sid": 436747368886825,
											"parameters": {
												"type": "log",
												"message": "Index"
											}
										},
										{
											"id": "set-at-xy",
											"objectClass": "PlayerBuffs",
											"sid": 438189688984580,
											"parameters": {
												"x": "Index",
												"y": "1",
												"value": "PlayerBuffs.At(Index, 1) - 1"
											}
										}
									],
									"sid": 432014333539704
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "compare-two-values",
											"objectClass": "System",
											"sid": 214847605291834,
											"parameters": {
												"first-value": "PlayerBuffs.At(Index, 1)",
												"comparison": 0,
												"second-value": "0"
											}
										}
									],
									"actions": [
										{
											"callFunction": "AppendToCombatLog",
											"sid": 897598379045727,
											"parameters": [
												"\"The \" & PlayerBuffs.At(Index, 0) & \" effect wears off on \" & Player.Name & \".\""
											]
										},
										{
											"id": "delete",
											"objectClass": "PlayerBuffs",
											"sid": 987522561849593,
											"parameters": {
												"index": "Index",
												"axis": "x"
											}
										}
									],
									"sid": 980770788314467
								}
							]
						},
						{
							"eventType": "block",
							"conditions": [],
							"actions": [
								{
									"id": "wait-for-previous-actions",
									"objectClass": "System",
									"sid": 312540525903603
								},
								{
									"callFunction": "RedrawBuffs",
									"sid": 572926691120595,
									"parameters": [
										"\"Player\""
									]
								}
							],
							"sid": 875011495779532
						}
					]
				}
			]
		},
		{
			"functionName": "EndEnemyTurn",
			"functionDescription": "",
			"functionCategory": "",
			"functionReturnType": "none",
			"functionIsAsync": false,
			"functionParameters": [],
			"eventType": "function-block",
			"conditions": [],
			"actions": [],
			"sid": 248732797159152,
			"children": [
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "compare-size",
							"objectClass": "EnemyBuffs",
							"sid": 264402003106110,
							"parameters": {
								"axis": "x",
								"comparison": 4,
								"value": "0"
							}
						}
					],
					"actions": [],
					"sid": 150480049508158,
					"children": [
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "for",
									"objectClass": "System",
									"sid": 841128700738842,
									"parameters": {
										"name": "\"\"",
										"start-index": "0",
										"end-index": "EnemyBuffs.Width - 1"
									}
								}
							],
							"actions": [
								{
									"type": "comment",
									"text": "reverse loop"
								},
								{
									"id": "log",
									"objectClass": "Browser",
									"sid": 289276182665322,
									"parameters": {
										"type": "log",
										"message": "\"looping backwards: indices:\""
									}
								}
							],
							"sid": 800795100354025,
							"children": [
								{
									"eventType": "variable",
									"name": "Index",
									"type": "number",
									"initialValue": "0",
									"comment": "",
									"isStatic": false,
									"isConstant": false,
									"sid": 376903211063703
								},
								{
									"eventType": "block",
									"conditions": [],
									"actions": [
										{
											"id": "set-eventvar-value",
											"objectClass": "System",
											"sid": 388936271184930,
											"parameters": {
												"variable": "Index",
												"value": "EnemyBuffs.Width - 1 - loopindex"
											}
										},
										{
											"id": "log",
											"objectClass": "Browser",
											"sid": 565911163771486,
											"parameters": {
												"type": "log",
												"message": "Index"
											}
										},
										{
											"id": "set-at-xy",
											"objectClass": "EnemyBuffs",
											"sid": 853384935076481,
											"parameters": {
												"x": "Index",
												"y": "1",
												"value": "EnemyBuffs.At(Index, 1) - 1"
											}
										}
									],
									"sid": 186907329298041
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "compare-two-values",
											"objectClass": "System",
											"sid": 741459945498833,
											"parameters": {
												"first-value": "EnemyBuffs.At(Index, 1)",
												"comparison": 0,
												"second-value": "0"
											}
										}
									],
									"actions": [
										{
											"callFunction": "AppendToCombatLog",
											"sid": 852561776714800,
											"parameters": [
												"\"The \" & EnemyBuffs.At(Index, 0) & \" effect wears off on \" & Enemy.Name & \".\""
											]
										},
										{
											"id": "delete",
											"objectClass": "EnemyBuffs",
											"sid": 852339308760256,
											"parameters": {
												"index": "Index",
												"axis": "x"
											}
										}
									],
									"sid": 577106692389895
								}
							]
						},
						{
							"eventType": "block",
							"conditions": [],
							"actions": [
								{
									"id": "wait-for-previous-actions",
									"objectClass": "System",
									"sid": 872641950618960
								},
								{
									"callFunction": "RedrawBuffs",
									"sid": 562272287412958,
									"parameters": [
										"\"Enemy\""
									]
								}
							],
							"sid": 584414021861041
						}
					]
				}
			]
		},
		{
			"functionName": "TakeEnemyTurn",
			"functionDescription": "",
			"functionCategory": "",
			"functionReturnType": "none",
			"functionIsAsync": false,
			"functionParameters": [],
			"eventType": "function-block",
			"conditions": [],
			"actions": [
				{
					"id": "wait",
					"objectClass": "System",
					"sid": 198748695884025,
					"parameters": {
						"seconds": "1"
					}
				},
				{
					"id": "wait-for-previous-actions",
					"objectClass": "System",
					"sid": 201588118623337
				},
				{
					"callFunction": "UseRandomEnemyAbility",
					"sid": 869772481701932,
					"parameters": [
						"\"Enemy\"",
						"Enemy.Level"
					]
				},
				{
					"callFunction": "EndEnemyTurn",
					"sid": 459468739695108
				}
			],
			"sid": 687586611543011
		},
		{
			"functionName": "PlayerDies",
			"functionDescription": "",
			"functionCategory": "",
			"functionReturnType": "none",
			"functionIsAsync": false,
			"functionParameters": [],
			"eventType": "function-block",
			"conditions": [],
			"actions": [
				{
					"id": "set-boolean-eventvar",
					"objectClass": "System",
					"sid": 102699239352319,
					"parameters": {
						"variable": "IsInCombat",
						"value": "false"
					}
				},
				{
					"id": "set-boolean-eventvar",
					"objectClass": "System",
					"sid": 749266299095172,
					"parameters": {
						"variable": "IsPlayerTurn",
						"value": "false"
					}
				},
				{
					"id": "destroy",
					"objectClass": "BuffDebuff",
					"sid": 572613445836912
				},
				{
					"callFunction": "AppendToCombatLog",
					"sid": 956879749227621,
					"parameters": [
						"\"You were defeated by the \" & Enemy.Name & \".\""
					]
				},
				{
					"id": "go-to-layout",
					"objectClass": "System",
					"sid": 931401367418814,
					"parameters": {
						"layout": "Death"
					}
				}
			],
			"sid": 700352390303312
		},
		{
			"functionName": "EnemyDies",
			"functionDescription": "",
			"functionCategory": "",
			"functionReturnType": "none",
			"functionIsAsync": false,
			"functionParameters": [],
			"eventType": "function-block",
			"conditions": [],
			"actions": [
				{
					"id": "set-boolean-eventvar",
					"objectClass": "System",
					"sid": 777565678335664,
					"parameters": {
						"variable": "IsPlayerTurn",
						"value": "false"
					}
				},
				{
					"callFunction": "AppendToCombatLog",
					"sid": 543018544545339,
					"parameters": [
						"\"You defeated the \" & Enemy.Name & \"!\""
					]
				},
				{
					"id": "set-visible",
					"objectClass": "Enemy",
					"sid": 506760131036536,
					"parameters": {
						"visibility": "invisible"
					}
				},
				{
					"id": "destroy",
					"objectClass": "BuffDebuff",
					"sid": 506714952792252
				},
				{
					"id": "delete",
					"objectClass": "EnemiesArray",
					"sid": 681702721509282,
					"parameters": {
						"index": "FocusedEnemyArrayIndex",
						"axis": "x"
					}
				}
			],
			"sid": 665859488933097,
			"children": [
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "compare-instance-variable",
							"objectClass": "HPText",
							"sid": 902883396060659,
							"parameters": {
								"instance-variable": "BelongsTo",
								"comparison": 0,
								"value": "\"Enemy\""
							}
						}
					],
					"actions": [
						{
							"id": "destroy",
							"objectClass": "HPText",
							"sid": 640114916914774
						}
					],
					"sid": 470975159891489
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "compare-instance-variable",
							"objectClass": "Enemy",
							"sid": 756477921060758,
							"parameters": {
								"instance-variable": "Level",
								"comparison": 4,
								"value": "Player.Level"
							}
						}
					],
					"actions": [
						{
							"callFunction": "LevelUp",
							"sid": 738177520889707
						}
					],
					"sid": 654114260793093
				},
				{
					"eventType": "block",
					"conditions": [],
					"actions": [
						{
							"id": "wait",
							"objectClass": "System",
							"sid": 537501195725579,
							"parameters": {
								"seconds": "1"
							}
						},
						{
							"id": "set-boolean-eventvar",
							"objectClass": "System",
							"sid": 226980771013807,
							"parameters": {
								"variable": "IsInCombat",
								"value": "false"
							}
						}
					],
					"sid": 644473739902311
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "compare-instance-variable",
							"objectClass": "Enemy",
							"sid": 472267313111241,
							"parameters": {
								"instance-variable": "Name",
								"comparison": 0,
								"value": "\"Dryad\""
							}
						}
					],
					"actions": [
						{
							"id": "go-to-layout",
							"objectClass": "System",
							"sid": 813469393212225,
							"parameters": {
								"layout": "Win"
							}
						}
					],
					"sid": 496982440016422
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "else",
							"objectClass": "System",
							"sid": 393987148120893
						}
					],
					"actions": [
						{
							"callFunction": "ShowLayer1",
							"sid": 603555425368111
						},
						{
							"id": "destroy",
							"objectClass": "HPText",
							"sid": 137718549611729
						}
					],
					"sid": 800825626977520
				}
			]
		},
		{
			"functionName": "AttemptToFlee",
			"functionDescription": "",
			"functionCategory": "",
			"functionReturnType": "none",
			"functionIsAsync": false,
			"functionParameters": [],
			"eventType": "function-block",
			"conditions": [],
			"actions": [
				{
					"callFunction": "AppendToCombatLog",
					"sid": 210140731106291,
					"parameters": [
						"\"You attempt to flee...\""
					]
				}
			],
			"sid": 459203606958434
		},
		{
			"eventType": "block",
			"conditions": [
				{
					"id": "on-tap-object",
					"objectClass": "Touch",
					"sid": 766997944211468,
					"parameters": {
						"object": "FleeButton"
					}
				},
				{
					"id": "compare-boolean-eventvar",
					"objectClass": "System",
					"sid": 692594918578341,
					"parameters": {
						"variable": "IsPlayerTurn"
					}
				}
			],
			"actions": [
				{
					"callFunction": "AttemptToFlee",
					"sid": 577660916806526
				},
				{
					"callFunction": "BlockPlayerCasting",
					"sid": 492095952534838
				},
				{
					"id": "wait",
					"objectClass": "System",
					"sid": 100875918378494,
					"parameters": {
						"seconds": "0.5"
					}
				}
			],
			"sid": 195832160913241,
			"children": [
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "compare-two-values",
							"objectClass": "System",
							"sid": 281971404620644,
							"parameters": {
								"first-value": "random(1)",
								"comparison": 4,
								"second-value": "0.7"
							}
						}
					],
					"actions": [
						{
							"callFunction": "AppendToCombatLog",
							"sid": 983075283949190,
							"parameters": [
								"\"You succeeded!\""
							]
						},
						{
							"id": "wait",
							"objectClass": "System",
							"sid": 309029759261477,
							"parameters": {
								"seconds": "1"
							}
						},
						{
							"id": "go-to-layout",
							"objectClass": "System",
							"sid": 458537426540945,
							"parameters": {
								"layout": "Overworld"
							}
						}
					],
					"sid": 150875318748646
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "else",
							"objectClass": "System",
							"sid": 177489843048179
						}
					],
					"actions": [
						{
							"callFunction": "AppendToCombatLog",
							"sid": 212631920211070,
							"parameters": [
								"\"Your attempt was unsuccessful.\""
							]
						},
						{
							"callFunction": "EndPlayerTurn",
							"sid": 819276989277939
						}
					],
					"sid": 863975993707011
				}
			]
		},
		{
			"functionName": "LevelUp",
			"functionDescription": "",
			"functionCategory": "",
			"functionReturnType": "none",
			"functionIsAsync": false,
			"functionParameters": [],
			"eventType": "function-block",
			"conditions": [],
			"actions": [
				{
					"id": "add-to-instvar",
					"objectClass": "Player",
					"sid": 664954800237542,
					"parameters": {
						"instance-variable": "Level",
						"value": "1"
					}
				},
				{
					"id": "add-to-eventvar",
					"objectClass": "System",
					"sid": 354142603469857,
					"parameters": {
						"variable": "PlayerLevel",
						"value": "1"
					}
				},
				{
					"callFunction": "AppendToCombatLog",
					"sid": 738688566019017,
					"parameters": [
						"\"You leveled up! You are now level \" & Player.Level & \".\""
					]
				},
				{
					"id": "add-to-eventvar",
					"objectClass": "System",
					"sid": 482759456317675,
					"parameters": {
						"variable": "PlayerMaxHP",
						"value": "Functions.RollDice(1, 6, 7)"
					}
				},
				{
					"id": "add-to-instvar",
					"objectClass": "Player",
					"sid": 612427671420794,
					"parameters": {
						"instance-variable": "MaxHP",
						"value": "PlayerMaxHP"
					}
				}
			],
			"sid": 856241846701377
		}
	],
	"sid": 772248937910943
}